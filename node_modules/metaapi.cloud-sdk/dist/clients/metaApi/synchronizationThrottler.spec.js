'use strict';

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

var _synchronizationThrottler = require('./synchronizationThrottler');

var _synchronizationThrottler2 = _interopRequireDefault(_synchronizationThrottler);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @test {SynchronizationThrottler}
 */
describe('SynchronizationThrottler', () => {
  let throttler, clock, sandbox, websocketClient;

  before(() => {
    sandbox = _sinon2.default.createSandbox();
  });

  beforeEach(() => {
    clock = _sinon2.default.useFakeTimers({
      now: new Date('2020-10-05T10:00:00.000Z'),
      shouldAdvanceTime: true
    });
    websocketClient = {
      _rpcRequest: (accountId, request, timeoutInSeconds) => {},
      subscribedAccountIds: () => new Array(11),
      socketInstances: [{ synchronizationThrottler: { synchronizingAccounts: [] } }]
    };
    websocketClient._rpcRequest = sandbox.stub();
    throttler = new _synchronizationThrottler2.default(websocketClient, 0);
    throttler.start();
  });

  afterEach(() => {
    clock.restore();
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should immediately send request if free slots exist', async () => {
    await throttler.scheduleSynchronize('accountId', { requestId: 'test' });
    _sinon2.default.assert.match(throttler._synchronizationIds, { test: 1601892000000 });
    throttler.removeSynchronizationId('test');
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test' });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not remove sync if different instance index', async () => {
    await throttler.scheduleSynchronize('accountId', { requestId: 'test', instanceIndex: 0 });
    await throttler.scheduleSynchronize('accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.match(throttler._synchronizationIds, { test: 1601892000000, test1: 1601892000000 });
    throttler.removeSynchronizationId('test', 0);
    _sinon2.default.assert.match(throttler._synchronizationIds, { test1: 1601892000000 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should wait for other sync requests to finish if slots are full', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should increase slot amount with more subscribed accounts', async () => {
    websocketClient.subscribedAccountIds = () => new Array(21);
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    await throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test3' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should set hard limit for concurrent synchronizations across throttlers via options', async () => {
    websocketClient.subscribedAccountIds = () => new Array(21);
    throttler = new _synchronizationThrottler2.default(websocketClient, 0, { maxConcurrentSynchronizations: 3 });
    websocketClient.socketInstances = [{ synchronizationThrottler: throttler }, { synchronizationThrottler: { synchronizingAccounts: ['accountId4'] } }];
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not take extra slots if sync ids belong to the same account', async () => {
    throttler.scheduleSynchronize('accountId', { requestId: 'test', instanceIndex: 0 });
    throttler.scheduleSynchronize('accountId', { requestId: 'test1', instanceIndex: 1 });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId', { requestId: 'test1', instanceIndex: 1 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.match(throttler._synchronizationIds, {});
  });

  /**
   * @test {SynchronizationThrottler#_removeOldSyncIdsJob}
   */
  it('should clear expired synchronization slots if no packets for 10 seconds', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    await clock.tickAsync(11000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#updateSynchronizationId}
   */
  it('should renew sync on update', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    await clock.tickAsync(11000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    await clock.tickAsync(11000);
    throttler.updateSynchronizationId('test1');
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should replace previous syncs', async () => {
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test5' });
    throttler.scheduleSynchronize('accountId1', { requestId: 'test3', instanceIndex: 0 });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#onDisconnect}
   */
  it('should clear existing sync ids on disconnect', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
    throttler.onDisconnect();
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await new _promise2.default(res => setTimeout(res, 20));
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
  });

  /**
   * @test {SynchronizationThrottler#_removeFromQueue}
   */
  it('should remove synchronizations from queue', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test4', instanceIndex: 0 });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test5' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test6' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test7' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test8' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test9' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test10', instanceIndex: 0 });
    await clock.tickAsync(53000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 6);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test8' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test10', instanceIndex: 0 });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId4', { requestId: 'test7' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId5', { requestId: 'test9' });
  });

  /**
   * @test {SynchronizationThrottler#_removeOldSyncIdsJob}
   */
  it('should remove expired synchronizations from queue', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    for (let i = 0; i < 20; i++) {
      await clock.tickAsync(8000);
      throttler.updateSynchronizationId('test1');
      throttler.updateSynchronizationId('test2');
    }
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    for (let i = 0; i < 20; i++) {
      await clock.tickAsync(8000);
      throttler.updateSynchronizationId('test1');
      throttler.updateSynchronizationId('test2');
    }
    await clock.tickAsync(33000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 3);
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId1', { requestId: 'test1' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test2' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId5', { requestId: 'test5' });
  });

  /**
   * @test {SynchronizationThrottler#scheduleSynchronize}
   */
  it('should not get queue stuck due to app synchronizations limit', async () => {
    throttler._client.socketInstances = [{ synchronizationThrottler: { synchronizingAccounts: ['accountId21', 'accountId22', 'accountId23', 'accountId24', 'accountId25', 'accountId26', 'accountId27', 'accountId28', 'accountId29', 'accountId210', 'accountId211', 'accountId212', 'accountId213', 'accountId214', 'accountId215'] } }, { synchronizationThrottler: throttler }];
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    await clock.tickAsync(5000);
    _sinon2.default.assert.notCalled(websocketClient._rpcRequest);
    throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts = throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts.slice(1);
    await clock.tickAsync(5000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 1);
    throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts = throttler._client.socketInstances[0].synchronizationThrottler.synchronizingAccounts.slice(1);
    await clock.tickAsync(5000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 2);
  });

  /**
   * @test {SynchronizationThrottler#removeSynchronizationId}
   */
  it('should not skip queue items when synchronization id is removed', async () => {
    throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test2' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test4' });
    throttler.scheduleSynchronize('accountId5', { requestId: 'test5' });
    await clock.tickAsync(2000);
    throttler.removeSynchronizationId('test3');
    await clock.tickAsync(2000);
    throttler.removeSynchronizationId('test1');
    throttler.removeSynchronizationId('test2');
    await clock.tickAsync(2000);
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });

  /**
   * @test {SynchronizationThrottler#removeIdByParameters}
   */
  it('should remove id by parameters', async () => {
    await throttler.scheduleSynchronize('accountId1', { requestId: 'test1' });
    await throttler.scheduleSynchronize('accountId2', { requestId: 'test2', instanceIndex: 0, host: 'ps-mpa-0' });
    throttler.scheduleSynchronize('accountId3', { requestId: 'test3' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test4', instanceIndex: 1, host: 'ps-mpa-1' });
    throttler.scheduleSynchronize('accountId2', { requestId: 'test5', instanceIndex: 0, host: 'ps-mpa-2' });
    throttler.scheduleSynchronize('accountId4', { requestId: 'test6' });
    await new _promise2.default(res => setTimeout(res, 50));
    throttler.scheduleSynchronize('accountId2', { requestId: 'test7', instanceIndex: 0, host: 'ps-mpa-3' });
    await new _promise2.default(res => setTimeout(res, 50));
    throttler.removeIdByParameters('accountId2', 0, 'ps-mpa-0');
    throttler.removeIdByParameters('accountId2', 0, 'ps-mpa-3');
    throttler.removeIdByParameters('accountId2', 1, 'ps-mpa-1');
    throttler.removeSynchronizationId('test1');
    await new _promise2.default(res => setTimeout(res, 50));
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId3', { requestId: 'test3' });
    _sinon2.default.assert.calledWith(websocketClient._rpcRequest, 'accountId2', { requestId: 'test5', instanceIndex: 0,
      host: 'ps-mpa-2' });
    _sinon2.default.assert.callCount(websocketClient._rpcRequest, 4);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jbGllbnRzL21ldGFBcGkvc3luY2hyb25pemF0aW9uVGhyb3R0bGVyLnNwZWMuZXM2Il0sIm5hbWVzIjpbImRlc2NyaWJlIiwidGhyb3R0bGVyIiwiY2xvY2siLCJzYW5kYm94Iiwid2Vic29ja2V0Q2xpZW50IiwiYmVmb3JlIiwic2lub24iLCJjcmVhdGVTYW5kYm94IiwiYmVmb3JlRWFjaCIsInVzZUZha2VUaW1lcnMiLCJub3ciLCJEYXRlIiwic2hvdWxkQWR2YW5jZVRpbWUiLCJfcnBjUmVxdWVzdCIsImFjY291bnRJZCIsInJlcXVlc3QiLCJ0aW1lb3V0SW5TZWNvbmRzIiwic3Vic2NyaWJlZEFjY291bnRJZHMiLCJBcnJheSIsInNvY2tldEluc3RhbmNlcyIsInN5bmNocm9uaXphdGlvblRocm90dGxlciIsInN5bmNocm9uaXppbmdBY2NvdW50cyIsInN0dWIiLCJTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIiLCJzdGFydCIsImFmdGVyRWFjaCIsInJlc3RvcmUiLCJpdCIsInNjaGVkdWxlU3luY2hyb25pemUiLCJyZXF1ZXN0SWQiLCJhc3NlcnQiLCJtYXRjaCIsIl9zeW5jaHJvbml6YXRpb25JZHMiLCJ0ZXN0IiwicmVtb3ZlU3luY2hyb25pemF0aW9uSWQiLCJjYWxsZWRXaXRoIiwiaW5zdGFuY2VJbmRleCIsInRlc3QxIiwicmVzIiwic2V0VGltZW91dCIsImNhbGxDb3VudCIsIm1heENvbmN1cnJlbnRTeW5jaHJvbml6YXRpb25zIiwidGlja0FzeW5jIiwidXBkYXRlU3luY2hyb25pemF0aW9uSWQiLCJvbkRpc2Nvbm5lY3QiLCJpIiwiX2NsaWVudCIsIm5vdENhbGxlZCIsInNsaWNlIiwiaG9zdCIsInJlbW92ZUlkQnlQYXJhbWV0ZXJzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQTs7O0FBR0FBLFNBQVMsMEJBQVQsRUFBcUMsTUFBTTtBQUN6QyxNQUFJQyxTQUFKLEVBQWVDLEtBQWYs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QlMsV0FBdkMsRUFBb0QsQ0FBcEQ7QUFDRCxHQW5CRDtBQXFCRCxDQWxTRCIsImZpbGUiOiJzeW5jaHJvbml6YXRpb25UaHJvdHRsZXIuc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIgZnJvbSAnLi9zeW5jaHJvbml6YXRpb25UaHJvdHRsZXInO1xuaW1wb3J0IHNpbm9uIGZyb20gJ3Npbm9uJztcblxuLyoqXG4gKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyfVxuICovXG5kZXNjcmliZSgnU3luY2hyb25pemF0aW9uVGhyb3R0bGVyJywgKCkgPT4ge1xuICBsZXQgdGhyb3R0bGVyLCBjbG9jaywgc2FuZGJveCwgd2Vic29ja2V0Q2xpZW50O1xuXG4gIGJlZm9yZSgoKSA9PiB7XG4gICAgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKTtcbiAgfSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgY2xvY2sgPSBzaW5vbi51c2VGYWtlVGltZXJzKHtcbiAgICAgIG5vdzogbmV3IERhdGUoJzIwMjAtMTAtMDVUMTA6MDA6MDAuMDAwWicpLFxuICAgICAgc2hvdWxkQWR2YW5jZVRpbWU6IHRydWVcbiAgICB9KTtcbiAgICB3ZWJzb2NrZXRDbGllbnQgPSB7XG4gICAgICBfcnBjUmVxdWVzdDogKGFjY291bnRJZCwgcmVxdWVzdCwgdGltZW91dEluU2Vjb25kcykgPT4ge30sXG4gICAgICBzdWJzY3JpYmVkQWNjb3VudElkczogKCkgPT4gbmV3IEFycmF5KDExKSxcbiAgICAgIHNvY2tldEluc3RhbmNlczogW3tzeW5jaHJvbml6YXRpb25UaHJvdHRsZXI6IHtzeW5jaHJvbml6aW5nQWNjb3VudHM6IFtdfX1dLFxuICAgIH07ICBcbiAgICB3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QgPSBzYW5kYm94LnN0dWIoKTtcbiAgICB0aHJvdHRsZXIgPSBuZXcgU3luY2hyb25pemF0aW9uVGhyb3R0bGVyKHdlYnNvY2tldENsaWVudCwgMCk7XG4gICAgdGhyb3R0bGVyLnN0YXJ0KCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgY2xvY2sucmVzdG9yZSgpO1xuICB9KTtcbiAgICBcbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgaW1tZWRpYXRlbHkgc2VuZCByZXF1ZXN0IGlmIGZyZWUgc2xvdHMgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0J30pO1xuICAgIHNpbm9uLmFzc2VydC5tYXRjaCh0aHJvdHRsZXIuX3N5bmNocm9uaXphdGlvbklkcywge3Rlc3Q6IDE2MDE4OTIwMDAwMDB9KTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QnKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdCd9KTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt9KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgbm90IHJlbW92ZSBzeW5jIGlmIGRpZmZlcmVudCBpbnN0YW5jZSBpbmRleCcsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkJywge3JlcXVlc3RJZDogJ3Rlc3QnLCBpbnN0YW5jZUluZGV4OiAwfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0MScsIGluc3RhbmNlSW5kZXg6IDF9KTtcbiAgICBzaW5vbi5hc3NlcnQubWF0Y2godGhyb3R0bGVyLl9zeW5jaHJvbml6YXRpb25JZHMsIHt0ZXN0OiAxNjAxODkyMDAwMDAwLCB0ZXN0MTogMTYwMTg5MjAwMDAwMH0pO1xuICAgIHRocm90dGxlci5yZW1vdmVTeW5jaHJvbml6YXRpb25JZCgndGVzdCcsIDApO1xuICAgIHNpbm9uLmFzc2VydC5tYXRjaCh0aHJvdHRsZXIuX3N5bmNocm9uaXphdGlvbklkcywge3Rlc3QxOiAxNjAxODkyMDAwMDAwfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkJywge3JlcXVlc3RJZDogJ3Rlc3QnLCBpbnN0YW5jZUluZGV4OiAwfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkJywge3JlcXVlc3RJZDogJ3Rlc3QxJywgaW5zdGFuY2VJbmRleDogMX0pO1xuICAgIHNpbm9uLmFzc2VydC5tYXRjaCh0aHJvdHRsZXIuX3N5bmNocm9uaXphdGlvbklkcywge30pO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNzY2hlZHVsZVN5bmNocm9uaXplfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCB3YWl0IGZvciBvdGhlciBzeW5jIHJlcXVlc3RzIHRvIGZpbmlzaCBpZiBzbG90cyBhcmUgZnVsbCcsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAyKTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QxJyk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgaW5jcmVhc2Ugc2xvdCBhbW91bnQgd2l0aCBtb3JlIHN1YnNjcmliZWQgYWNjb3VudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgd2Vic29ja2V0Q2xpZW50LnN1YnNjcmliZWRBY2NvdW50SWRzID0gKCkgPT4gbmV3IEFycmF5KDIxKTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMyk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3NjaGVkdWxlU3luY2hyb25pemV9XG4gICAqL1xuICBpdCgnc2hvdWxkIHNldCBoYXJkIGxpbWl0IGZvciBjb25jdXJyZW50IHN5bmNocm9uaXphdGlvbnMgYWNyb3NzIHRocm90dGxlcnMgdmlhIG9wdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgd2Vic29ja2V0Q2xpZW50LnN1YnNjcmliZWRBY2NvdW50SWRzID0gKCkgPT4gbmV3IEFycmF5KDIxKTtcbiAgICB0aHJvdHRsZXIgPSBuZXcgU3luY2hyb25pemF0aW9uVGhyb3R0bGVyKHdlYnNvY2tldENsaWVudCwgMCwge21heENvbmN1cnJlbnRTeW5jaHJvbml6YXRpb25zOiAzfSk7XG4gICAgd2Vic29ja2V0Q2xpZW50LnNvY2tldEluc3RhbmNlcyA9IFt7c3luY2hyb25pemF0aW9uVGhyb3R0bGVyOiB0aHJvdHRsZXJ9LFxuICAgICAge3N5bmNocm9uaXphdGlvblRocm90dGxlcjoge3N5bmNocm9uaXppbmdBY2NvdW50czogWydhY2NvdW50SWQ0J119fV07XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDQnLCB7cmVxdWVzdElkOiAndGVzdDQnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAyKTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QxJyk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgbm90IHRha2UgZXh0cmEgc2xvdHMgaWYgc3luYyBpZHMgYmVsb25nIHRvIHRoZSBzYW1lIGFjY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0JywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQnLCB7cmVxdWVzdElkOiAndGVzdDEnLCBpbnN0YW5jZUluZGV4OiAxfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDMpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0JywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0MScsIGluc3RhbmNlSW5kZXg6IDF9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHNpbm9uLmFzc2VydC5tYXRjaCh0aHJvdHRsZXIuX3N5bmNocm9uaXphdGlvbklkcywge30pO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNfcmVtb3ZlT2xkU3luY0lkc0pvYn1cbiAgICovXG4gIGl0KCdzaG91bGQgY2xlYXIgZXhwaXJlZCBzeW5jaHJvbml6YXRpb24gc2xvdHMgaWYgbm8gcGFja2V0cyBmb3IgMTAgc2Vjb25kcycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDIwKSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDIpO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYygxMTAwMCk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDMpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciN1cGRhdGVTeW5jaHJvbml6YXRpb25JZH1cbiAgICovXG4gIGl0KCdzaG91bGQgcmVuZXcgc3luYyBvbiB1cGRhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgYXdhaXQgbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQocmVzLCAyMCkpO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAyKTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoMTEwMDApO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoMTEwMDApO1xuICAgIHRocm90dGxlci51cGRhdGVTeW5jaHJvbml6YXRpb25JZCgndGVzdDEnKTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNCcsIHtyZXF1ZXN0SWQ6ICd0ZXN0NCd9KTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkNScsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDIwKSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDQpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNzY2hlZHVsZVN5bmNocm9uaXplfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCByZXBsYWNlIHByZXZpb3VzIHN5bmNzJywgYXN5bmMgKCkgPT4ge1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3Q0J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3Q1J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QzJywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgMjApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgNCk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI29uRGlzY29ubmVjdH1cbiAgICovXG4gIGl0KCdzaG91bGQgY2xlYXIgZXhpc3Rpbmcgc3luYyBpZHMgb24gZGlzY29ubmVjdCcsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMScsIHtyZXF1ZXN0SWQ6ICd0ZXN0MSd9KTtcbiAgICBhd2FpdCB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0Mid9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDIwKSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDIpO1xuICAgIHRocm90dGxlci5vbkRpc2Nvbm5lY3QoKTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0Myd9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDIwKSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxDb3VudCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsIDMpO1xuICB9KTtcblxuICAvKipcbiAgICogQHRlc3Qge1N5bmNocm9uaXphdGlvblRocm90dGxlciNfcmVtb3ZlRnJvbVF1ZXVlfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCByZW1vdmUgc3luY2hyb25pemF0aW9ucyBmcm9tIHF1ZXVlJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3Q0JywgaW5zdGFuY2VJbmRleDogMH0pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q1J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3Q2J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q3J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3Q4J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ1Jywge3JlcXVlc3RJZDogJ3Rlc3Q5J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QxMCcsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoNTMwMDApO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCA2KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkMycsIHtyZXF1ZXN0SWQ6ICd0ZXN0OCd9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QxMCcsIGluc3RhbmNlSW5kZXg6IDB9KTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q3J30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDUnLCB7cmVxdWVzdElkOiAndGVzdDknfSk7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI19yZW1vdmVPbGRTeW5jSWRzSm9ifVxuICAgKi9cbiAgaXQoJ3Nob3VsZCByZW1vdmUgZXhwaXJlZCBzeW5jaHJvbml6YXRpb25zIGZyb20gcXVldWUnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDEnLCB7cmVxdWVzdElkOiAndGVzdDEnfSk7XG4gICAgYXdhaXQgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDMnLCB7cmVxdWVzdElkOiAndGVzdDMnfSk7XG4gICAgdGhyb3R0bGVyLnNjaGVkdWxlU3luY2hyb25pemUoJ2FjY291bnRJZDQnLCB7cmVxdWVzdElkOiAndGVzdDQnfSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoODAwMCk7XG4gICAgICB0aHJvdHRsZXIudXBkYXRlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QxJyk7XG4gICAgICB0aHJvdHRsZXIudXBkYXRlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QyJyk7XG4gICAgfVxuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ1Jywge3JlcXVlc3RJZDogJ3Rlc3Q1J30pO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDgwMDApO1xuICAgICAgdGhyb3R0bGVyLnVwZGF0ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgICAgdGhyb3R0bGVyLnVwZGF0ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MicpO1xuICAgIH1cbiAgICBhd2FpdCBjbG9jay50aWNrQXN5bmMoMzMwMDApO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAzKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDInfSk7XG4gICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGgod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCAnYWNjb3VudElkNScsIHtyZXF1ZXN0SWQ6ICd0ZXN0NSd9KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjc2NoZWR1bGVTeW5jaHJvbml6ZX1cbiAgICovXG4gIGl0KCdzaG91bGQgbm90IGdldCBxdWV1ZSBzdHVjayBkdWUgdG8gYXBwIHN5bmNocm9uaXphdGlvbnMgbGltaXQnLCBhc3luYyAoKSA9PiB7XG4gICAgdGhyb3R0bGVyLl9jbGllbnQuc29ja2V0SW5zdGFuY2VzID0gW3tzeW5jaHJvbml6YXRpb25UaHJvdHRsZXI6IHtzeW5jaHJvbml6aW5nQWNjb3VudHM6IFtcbiAgICAgICdhY2NvdW50SWQyMScsICdhY2NvdW50SWQyMicsICdhY2NvdW50SWQyMycsICdhY2NvdW50SWQyNCcsICdhY2NvdW50SWQyNScsICdhY2NvdW50SWQyNicsXG4gICAgICAnYWNjb3VudElkMjcnLCAnYWNjb3VudElkMjgnLCAnYWNjb3VudElkMjknLCAnYWNjb3VudElkMjEwJywgJ2FjY291bnRJZDIxMScsICdhY2NvdW50SWQyMTInLCBcbiAgICAgICdhY2NvdW50SWQyMTMnLCAnYWNjb3VudElkMjE0JywgJ2FjY291bnRJZDIxNSddfX0sIHtzeW5jaHJvbml6YXRpb25UaHJvdHRsZXI6IHRocm90dGxlcn1dO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYyg1MDAwKTtcbiAgICBzaW5vbi5hc3NlcnQubm90Q2FsbGVkKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCk7XG4gICAgdGhyb3R0bGVyLl9jbGllbnQuc29ja2V0SW5zdGFuY2VzWzBdLnN5bmNocm9uaXphdGlvblRocm90dGxlci5zeW5jaHJvbml6aW5nQWNjb3VudHMgPSBcbiAgICAgIHRocm90dGxlci5fY2xpZW50LnNvY2tldEluc3RhbmNlc1swXS5zeW5jaHJvbml6YXRpb25UaHJvdHRsZXIuc3luY2hyb25pemluZ0FjY291bnRzLnNsaWNlKDEpO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYyg1MDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMSk7XG4gICAgdGhyb3R0bGVyLl9jbGllbnQuc29ja2V0SW5zdGFuY2VzWzBdLnN5bmNocm9uaXphdGlvblRocm90dGxlci5zeW5jaHJvbml6aW5nQWNjb3VudHMgPSBcbiAgICAgIHRocm90dGxlci5fY2xpZW50LnNvY2tldEluc3RhbmNlc1swXS5zeW5jaHJvbml6YXRpb25UaHJvdHRsZXIuc3luY2hyb25pemluZ0FjY291bnRzLnNsaWNlKDEpO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYyg1MDAwKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbENvdW50KHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgMik7XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBAdGVzdCB7U3luY2hyb25pemF0aW9uVGhyb3R0bGVyI3JlbW92ZVN5bmNocm9uaXphdGlvbklkfVxuICAgKi9cbiAgaXQoJ3Nob3VsZCBub3Qgc2tpcCBxdWV1ZSBpdGVtcyB3aGVuIHN5bmNocm9uaXphdGlvbiBpZCBpcyByZW1vdmVkJywgYXN5bmMgKCkgPT4ge1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q0J30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ1Jywge3JlcXVlc3RJZDogJ3Rlc3Q1J30pO1xuICAgIGF3YWl0IGNsb2NrLnRpY2tBc3luYygyMDAwKTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QzJyk7XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDIwMDApO1xuICAgIHRocm90dGxlci5yZW1vdmVTeW5jaHJvbml6YXRpb25JZCgndGVzdDEnKTtcbiAgICB0aHJvdHRsZXIucmVtb3ZlU3luY2hyb25pemF0aW9uSWQoJ3Rlc3QyJyk7XG4gICAgYXdhaXQgY2xvY2sudGlja0FzeW5jKDIwMDApO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCA0KTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEB0ZXN0IHtTeW5jaHJvbml6YXRpb25UaHJvdHRsZXIjcmVtb3ZlSWRCeVBhcmFtZXRlcnN9XG4gICAqL1xuICBpdCgnc2hvdWxkIHJlbW92ZSBpZCBieSBwYXJhbWV0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQxJywge3JlcXVlc3RJZDogJ3Rlc3QxJ30pO1xuICAgIGF3YWl0IHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3QyJywgaW5zdGFuY2VJbmRleDogMCwgaG9zdDogJ3BzLW1wYS0wJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3Q0JywgaW5zdGFuY2VJbmRleDogMSwgaG9zdDogJ3BzLW1wYS0xJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQyJywge3JlcXVlc3RJZDogJ3Rlc3Q1JywgaW5zdGFuY2VJbmRleDogMCwgaG9zdDogJ3BzLW1wYS0yJ30pO1xuICAgIHRocm90dGxlci5zY2hlZHVsZVN5bmNocm9uaXplKCdhY2NvdW50SWQ0Jywge3JlcXVlc3RJZDogJ3Rlc3Q2J30pO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgNTApKTtcbiAgICB0aHJvdHRsZXIuc2NoZWR1bGVTeW5jaHJvbml6ZSgnYWNjb3VudElkMicsIHtyZXF1ZXN0SWQ6ICd0ZXN0NycsIGluc3RhbmNlSW5kZXg6IDAsIGhvc3Q6ICdwcy1tcGEtMyd9KTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXMgPT4gc2V0VGltZW91dChyZXMsIDUwKSk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZUlkQnlQYXJhbWV0ZXJzKCdhY2NvdW50SWQyJywgMCwgJ3BzLW1wYS0wJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZUlkQnlQYXJhbWV0ZXJzKCdhY2NvdW50SWQyJywgMCwgJ3BzLW1wYS0zJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZUlkQnlQYXJhbWV0ZXJzKCdhY2NvdW50SWQyJywgMSwgJ3BzLW1wYS0xJyk7XG4gICAgdGhyb3R0bGVyLnJlbW92ZVN5bmNocm9uaXphdGlvbklkKCd0ZXN0MScpO1xuICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlcyA9PiBzZXRUaW1lb3V0KHJlcywgNTApKTtcbiAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aCh3ZWJzb2NrZXRDbGllbnQuX3JwY1JlcXVlc3QsICdhY2NvdW50SWQzJywge3JlcXVlc3RJZDogJ3Rlc3QzJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsZWRXaXRoKHdlYnNvY2tldENsaWVudC5fcnBjUmVxdWVzdCwgJ2FjY291bnRJZDInLCB7cmVxdWVzdElkOiAndGVzdDUnLCBpbnN0YW5jZUluZGV4OiAwLFxuICAgICAgaG9zdDogJ3BzLW1wYS0yJ30pO1xuICAgIHNpbm9uLmFzc2VydC5jYWxsQ291bnQod2Vic29ja2V0Q2xpZW50Ll9ycGNSZXF1ZXN0LCA0KTtcbiAgfSk7XG5cbn0pOyJdfQ==